#!/bin/bash

echo "-----> Installing Heroku Toolbelt"

set -e

BUILD_DIR=$1
CACHE_DIR=$2

mkdir -p $CACHE_DIR
mkdir -p $BUILD_DIR/vendor

curl -s https://s3.amazonaws.com/assets.heroku.com/heroku-client/heroku-client.tgz -o $CACHE_DIR/heroku-client.tgz
tar xz $CACHE_DIR/heroku-client.tgz

mv $CACHE_DIR/heroku-client $BUILD_DIR/vendor/heroku-client

echo "-----> exporting PATH for Heroku Toolbelt"
PROFILE_PATH="$BUILD_DIR/.profile.d/heroku.sh"
mkdir -p $(dirname $PROFILE_PATH)
echo 'export PATH="$PATH:vendor/heroku-client/bin"' >> $PROFILE_PATH

echo "-----> Heroku Toolbelt Installed"